<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.245">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>R Packages (2e) - 20&nbsp; R CMD check</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./continuous-integration.html" rel="next">
<link href="./website.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><script defer="" data-domain="r-pkgs.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title"><code>R CMD check</code></span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">R Packages (2e)</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/hadley/r-pkgs/" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle sidebar-tool" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Welcome!</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Preface.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Getting started</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Whole-game.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">The whole game</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Setup.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">System setup</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Structure.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Package structure and state</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Workflow101.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Fundamental development workflows</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Package-within.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">The package within</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Package components</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Code.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">R code</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./misc.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Other components</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">Package metadata</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Metadata.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title"><code>DESCRIPTION</code> and <code>NAMESPACE</code></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dependencies.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Dependencies: What does your package need?</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./license.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Licensing</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Testing</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./testing-basics.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Testing basics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./testing-design.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Designing your test suite</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./testing-advanced.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Advanced testing techniques</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">Documentation</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./man.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Function documentation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./vignettes.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Vignettes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./other-markdown.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Other markdown files</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./website.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Website</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">Maintenance and distribution</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./check.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title"><code>R CMD check</code></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./continuous-integration.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Continuous integration</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./release.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Releasing to CRAN</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lifecycle.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Lifecycle</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">References</span></a>
  </div>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="toc-section-number">20.1</span>  Introduction</a></li>
  <li><a href="#check-workflow" id="toc-check-workflow" class="nav-link" data-scroll-target="#check-workflow"><span class="toc-section-number">20.2</span>  Workflow</a></li>
  <li>
<a href="#sec-check-checks" id="toc-sec-check-checks" class="nav-link" data-scroll-target="#sec-check-checks"><span class="toc-section-number">20.3</span>  Checks</a>
  <ul class="collapse">
<li><a href="#check-metadata" id="toc-check-metadata" class="nav-link" data-scroll-target="#check-metadata"><span class="toc-section-number">20.3.1</span>  Check metadata</a></li>
  <li><a href="#package-structure" id="toc-package-structure" class="nav-link" data-scroll-target="#package-structure"><span class="toc-section-number">20.3.2</span>  Package structure</a></li>
  <li><a href="#description" id="toc-description" class="nav-link" data-scroll-target="#description"><span class="toc-section-number">20.3.3</span>  Description</a></li>
  <li><a href="#namespace" id="toc-namespace" class="nav-link" data-scroll-target="#namespace"><span class="toc-section-number">20.3.4</span>  Namespace</a></li>
  <li><a href="#r-code" id="toc-r-code" class="nav-link" data-scroll-target="#r-code"><span class="toc-section-number">20.3.5</span>  R code</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data"><span class="toc-section-number">20.3.6</span>  Data</a></li>
  <li><a href="#documentation" id="toc-documentation" class="nav-link" data-scroll-target="#documentation"><span class="toc-section-number">20.3.7</span>  Documentation</a></li>
  <li><a href="#demos" id="toc-demos" class="nav-link" data-scroll-target="#demos"><span class="toc-section-number">20.3.8</span>  Demos</a></li>
  <li><a href="#compiled-code" id="toc-compiled-code" class="nav-link" data-scroll-target="#compiled-code"><span class="toc-section-number">20.3.9</span>  Compiled code</a></li>
  <li><a href="#vignettes" id="toc-vignettes" class="nav-link" data-scroll-target="#vignettes"><span class="toc-section-number">20.3.10</span>  Vignettes</a></li>
  </ul>
</li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/hadley/r-pkgs/edit/main/check.Rmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/hadley/r-pkgs/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-r-cmd-check" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title"><code>R CMD check</code></span></span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header><div class="cell">
<div class="cell-output-display">
<div class="callout-warning callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Second edition
</div>
</div>
<div class="callout-body-container callout-body">
<p>You are reading the work-in-progress second edition of R Packages. This chapter is undergoing heavy restructuring and may be confusing or incomplete.</p>
</div>
</div>
</div>
</div>
<section id="introduction" class="level2" data-number="20.1"><h2 data-number="20.1" class="anchored" data-anchor-id="introduction">
<span class="header-section-number">20.1</span> Introduction</h2>
<p>An important part of the package development process is <code>R CMD check</code>. <code>R CMD check</code> automatically checks your code for common problems. It’s essential if you’re planning on submitting to CRAN, but it’s useful even if you’re not because it automatically detects many common problems that you’d otherwise discover the hard way.</p>
<p><code>R CMD check</code> will be frustrating the first time you run it - you’ll discover many problems that need to be fixed. The key to making <code>R CMD check</code> less frustrating is to actually run it more often: the sooner you find a problem, the easier it is to fix. The upper limit of this approach is to run <code>R CMD check</code> every time you make a change. If you use GitHub, you’ll learn precisely how to do that in <a href="continuous-integration.html#sec-gha"><span>Section&nbsp;21.2</span></a>.</p>
</section><section id="check-workflow" class="level2" data-number="20.2"><h2 data-number="20.2" class="anchored" data-anchor-id="check-workflow">
<span class="header-section-number">20.2</span> Workflow</h2>
<p><code>R CMD check</code> is the name of the command you run from the terminal. I don’t recommend calling it directly. Instead, run <code><a href="https://devtools.r-lib.org/reference/check.html">devtools::check()</a></code>, or press Ctrl/Cmd + Shift + E in RStudio. In contrast to <code>R CMD check</code>, <code><a href="https://devtools.r-lib.org/reference/check.html">devtools::check()</a></code>:</p>
<ul>
<li><p>Ensures that the documentation is up-to-date by running <code><a href="https://devtools.r-lib.org/reference/document.html">devtools::document()</a></code>.</p></li>
<li><p>Bundles the package before checking it. This is the best practice for checking packages because it makes sure the check starts with a clean slate: because a package bundle doesn’t contain any of the temporary files that can accumulate in your source package, e.g.&nbsp;artifacts like <code>.so</code> and <code>.o</code> files which accompany compiled code, you can avoid the spurious warnings such files will generate.</p></li>
<li><p>Sets the <code>NOT_CRAN</code> environment variable to <code>TRUE</code>. This allows you to selectively skip tests on CRAN. (See <code><a href="https://testthat.r-lib.org/reference/skip.html">?testthat::skip_on_cran</a></code> for details.)</p></li>
</ul>
<p>The workflow for checking a package is simple, but tedious:</p>
<ol type="1">
<li><p>Run <code><a href="https://devtools.r-lib.org/reference/check.html">devtools::check()</a></code>, or press Ctrl/Cmd + Shift + E.</p></li>
<li><p>Fix the first problem.</p></li>
<li><p>Repeat until there are no more problems.</p></li>
</ol>
<p><code>R CMD check</code> returns three types of messages:</p>
<ul>
<li><p><code>ERROR</code>s: Severe problems that you should fix regardless of whether or not you’re submitting to CRAN.</p></li>
<li><p><code>WARNING</code>s: Likely problems that you must fix if you’re planning to submit to CRAN (and a good idea to look into even if you’re not).</p></li>
<li><p><code>NOTE</code>s: Mild problems. If you are submitting to CRAN, you should strive to eliminate all NOTEs, even if they are false positives. If you have no NOTEs, human intervention is not required, and the package submission process will be easier. If it’s not possible to eliminate a <code>NOTE</code>, you’ll need describe why it’s OK in your submission comments, as described in <a href="release.html#sec-release-process"><span>Section&nbsp;22.2</span></a>. If you’re not submitting to CRAN, carefully read each NOTE, but don’t go out of your way to fix things that you don’t think are problems.</p></li>
</ul></section><section id="sec-check-checks" class="level2" data-number="20.3"><h2 data-number="20.3" class="anchored" data-anchor-id="sec-check-checks">
<span class="header-section-number">20.3</span> Checks</h2>
<p><code>R CMD check</code> is composed of over 50 individual checks, described in the following sections. For each check, I briefly describe what it does, what the most common problems are, and how to fix them. When you have a problem with <code>R CMD check</code> and can’t understand how to fix it, use this list to help figure out what you need to do. To make it easier to understand how the checks fit together, I’ve organised them into sections roughly corresponding to the chapters in this book. This means they will be in a somewhat different order to what you’ll see when you run <code>check()</code>.</p>
<p>This list includes every check run in R 3.1.1. If you’re using a more recent version, you may want to consult the most recent online version of this chapter: <a href="https://r-pkgs.org/r-cmd-check.html" class="uri">https://r-pkgs.org/r-cmd-check.html</a>. Please <a href="mailto:hadley@rstudio.com">let me know</a> if you encounter a problem that this chapter doesn’t help with.</p>
<section id="check-metadata" class="level3" data-number="20.3.1"><h3 data-number="20.3.1" class="anchored" data-anchor-id="check-metadata">
<span class="header-section-number">20.3.1</span> Check metadata</h3>
<p><code>R CMD check</code> always starts by describing your current environment. I’m running R 3.1.1 on OS X with a UTF-8 charset:</p>
<ul>
<li>
<strong>Using log directory</strong> ‘/Users/hadley/Documents/web/httr.Rcheck’</li>
<li>
<strong>Using R version</strong> 3.1.1 (2014-07-10)</li>
<li>
<strong>Using platform</strong>: x86_64-apple-darwin13.1.0 (64-bit)</li>
<li>
<strong>Using session charset</strong>: UTF-8</li>
</ul>
<p>Next the description is parsed and the package version is printed. Here I’m checking httr version 0.5.0.9000 (you’ll learn more about that weird version number in <a href="lifecycle.html#sec-release-version"><span>Section&nbsp;23.3</span></a>).</p>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L3459 -->
<ul>
<li>
<strong>Checking for file</strong> ‘httr/DESCRIPTION’</li>
<li>
<strong>This is package</strong> ‘httr’ <strong>version</strong> ‘0.5.0.9000’</li>
</ul></section><section id="package-structure" class="level3" data-number="20.3.2"><h3 data-number="20.3.2" class="anchored" data-anchor-id="package-structure">
<span class="header-section-number">20.3.2</span> Package structure</h3>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L257 -->
<ul>
<li>
<strong>Checking package directory</strong>. The directory you’re checking must exist - <code><a href="https://devtools.r-lib.org/reference/check.html">devtools::check()</a></code> protects you against this problem.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L3720 --><ul>
<li>
<strong>Checking if this is a source package</strong>. You must check a source package, not a binary or installed package. This should never fail if you use<br><code><a href="https://devtools.r-lib.org/reference/check.html">devtools::check()</a></code>.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L3015 --><ul>
<li>
<strong>Checking for executable files</strong>. You must not have executable files in your package: they’re not portable, they’re not open source, and they are a security risk. Delete any executable files from your package. (If you’re not submitting to CRAN, you can silence this warning by listing each executable file in the <code>BinaryFiles</code> field in your <code>DESCRIPTION</code>.)</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L3103 --><ul>
<li>
<strong>Checking for hidden files and directories</strong>. On Linux and OS X, files with a name starting with <code>.</code> are hidden by default, and you’ve probably included them in your package by mistake. Either delete them, or if they are important, use <code>.Rbuildignore</code> to remove them from the package bundle. R automatically removes some common directories like <code>.git</code> and <code>.svn</code>.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L381 --><ul>
<li>
<strong>Checking for portable file names</strong>. R packages must work on Windows, Linux and OS X, so you can only use file names that work on all platforms. The easiest way to do this is to stick to letters, numbers, underscores and dashes. Avoid non-English letters and spaces. Fix this check by renaming the listed files.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L541 --><ul>
<li>
<strong>Checking for sufficient/correct file permissions</strong>. If you can’t read a file, you can’t check it. This check detects the unlikely occurence that you have files in the package that you don’t have permission to read. Fix this problem by fixing the file permissions.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L3141 --><ul>
<li>
<strong>Checking whether package ‘XYZ’ can be installed</strong>. <code>R CMD check</code> runs <code>R CMD install</code> to make sure that it’s possible to install your package. If this fails, you should run <code><a href="https://devtools.r-lib.org/reference/install.html">devtools::install()</a></code> or RStudio’s Build &amp; Reload and debug any problems before continuing.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L3459 --><ul>
<li>
<p><strong>Checking installed package size</strong>. It’s easy to accidentally include large files that blow up the size of your package. This check ensures that the whole package is less than 5 MB and each subdirectory is less than 1 MB. If you see this message, check that you haven’t accidentally included a large file.</p>
<p>If submitting to CRAN, you’ll need to justify the size of your package. First, make sure the package is as small as it possibly can be: try recompressing the data, <a href="data.html#sec-data-cran"><span>Section&nbsp;8.6</span></a>; and minimising vignettes, <a href="vignettes.html"><span>Chapter&nbsp;17</span></a>. If it’s still too large, consider moving data into its own package.</p>
</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L746 --><ul>
<li>
<p><strong>Checking top-level files</strong>. Only specified files and directories are allowed at the top level of the package (e.g.&nbsp;<code>DESCRIPTION</code>, <code>R/</code>, <code>src/</code>). To include other files, you have two choices:</p>
<ul>
<li><p>If they don’t need to be installed (i.e.&nbsp;they’re only used in the source package): add them to <code>.Rbuildignore</code> with <code><a href="https://usethis.r-lib.org/reference/use_build_ignore.html">usethis::use_build_ignore()</a></code>.</p></li>
<li><p>If they need to be installed: move them into <code>inst/</code>. They’ll be moved back to the top-level package directory when installed.</p></li>
</ul>
</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L924 --><ul>
<li>
<p><strong>Checking package subdirectories</strong>.</p>
<ul>
<li><p>Don’t include any empty directories. These are usually removed automatically by <code>R CMD build</code> so you shouldn’t see this error. If you do, just delete the directory.</p></li>
<li><p>The case of files and directories is important. All sub-directories should be lower-case, except for <code>R/</code>. A citation file, if present, should be in <code>inst/CITATION</code>. Rename as needed.</p></li>
<li><p>The contents of <code>inst/</code> shouldn’t clash with top-level contents of the package (like <code>build/</code>, <code>R/</code> etc). If they do, rename your files/directories.</p></li>
</ul>
</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L859 --><ul>
<li>
<strong>Checking for left-over files</strong>. Remove any files listed here. They’ve been included in your package by accident.</li>
</ul></section><section id="description" class="level3" data-number="20.3.3"><h3 data-number="20.3.3" class="anchored" data-anchor-id="description">
<span class="header-section-number">20.3.3</span> Description</h3>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L597 -->
<ul>
<li>
<p><strong>Checking DESCRIPTION meta-information</strong>.</p>
<ul>
<li><p>The <code>DESCRIPTION</code> must be valid. You are unlikely to see this error, because <code><a href="https://devtools.r-lib.org/reference/load_all.html">devtools::load_all()</a></code> runs the same check each time you re-load the package.</p></li>
<li><p>If you use any non-ASCII characters in the DESCRIPTION, you must also specify an encoding. There are only three encodings that work on all platforms: latin1, latin2 and UTF-8. I strongly recommend UTF-8: <code>Encoding: UTF-8</code>.</p></li>
<li><p>The <code>License</code> must refer to either a known license (a complete list can be found at <a href="https://svn.r-project.org/R/trunk/share/licenses/license.db" class="uri">https://svn.r-project.org/R/trunk/share/licenses/license.db</a>), or it must use <code>file LICENSE</code> and that file must exist. Errors here are most likely to be typos.</p></li>
<li><p>You should either provide <code>Authors@R</code> or <code>Authors</code> and <code>Maintainer</code>. You’ll get an error if you’ve specified both, which you can fix by removing the one you didn’t want.</p></li>
</ul>
</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L3683
tools:::.check_package_depends --><ul>
<li>
<p><strong>Checking package dependencies</strong>.</p>
<ul>
<li><p>All packages listed in <code>Depends</code>, <code>Imports</code> and <code>LinkingTo</code> must be installed, and their version requirements must be met, otherwise your package can’t be checked. An easy way to install any missing or outdated dependencies is to run <code>devtools::install_deps(dependencies = TRUE)</code>.</p></li>
<li><p>Packages listed in <code>Suggests</code> must be installed, unless you’ve set the environment variable <code>_R_CHECK_FORCE_SUGGESTS_</code> to a false value (e.g.&nbsp;with <code>check(force_suggests = FALSE)</code>). This is useful if some of the suggested packages are not available on all platforms.</p></li>
<li><p>R packages can not have a cycle of dependencies: i.e.&nbsp;if package A requires B, then B can not require A (otherwise which one would you load first?). If you see this error, you’ll need to rethink the design of your package. One easy fix is to move the conflicting package from <code>Imports</code> or <code>Depends</code> to <code>Suggests</code>.</p></li>
<li><p>Any packages used in the <code>NAMESPACE</code> must be listed in one of <code>Imports</code> (most commonly) or <code>Depends</code> (only in special cases). See <a href="dependencies.html#sec-search-path"><span>Section&nbsp;11.5.2</span></a> for more details.</p></li>
<li><p>Every package listed in <code>Depends</code> must also be imported in the <code>NAMESPACE</code> or accessed with <code>pkg::foo</code>. If you don’t do this, your package will work when attached to the search path (with <code><a href="https://rdrr.io/r/base/library.html">library(mypackage)</a></code>) but will not work when only loaded (e.g.&nbsp;<code>mypackage::foo()</code>)</p></li>
</ul>
</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L3561 
tools:::.check_package_CRAN_incoming
--><ul>
<li>
<p><strong>Checking CRAN incoming feasibility</strong>. These checks only apply if you’re submitting to CRAN.</p>
<ul>
<li><p>If you’re submitting a new package, you can’t use the same name as an existing package. You’ll need to come up with a new name.</p></li>
<li><p>If you’re submitting an update, the version number must be higher than the current CRAN version. Update the <code>Version</code> field in <code>DESCRIPTION</code>.</p></li>
<li><p>If the maintainer of the package has changed (even if it’s just a change in email address), the new maintainer should submit to CRAN, and the old maintainer should send a confirmation email.</p></li>
<li><p>You must use a standard open source license, as listed in <a href="https://svn.r-project.org/R/trunk/share/licenses/license.db" class="uri">https://svn.r-project.org/R/trunk/share/licenses/license.db</a>. You can not use a custom license as CRAN does not have the legal resources to review custom agreements.</p></li>
<li><p>The <code>Title</code> and <code>Description</code> must be free from spelling mistakes. The title of the package must be in title case. Neither title nor description should include either the name of your package or the word “package”. Reword your title and description as needed.</p></li>
<li><p>If you’re submitting a new package, you’ll always get a <code>NOTE</code>. This reminds the CRAN maintainers to do some extra manual checks.</p></li>
<li><p>Avoid submitting multiple versions of the same package in a short period of time. CRAN prefers at most one submission per month. If you need to fix a major bug, be apologetic.</p></li>
</ul>
</li>
</ul></section><section id="namespace" class="level3" data-number="20.3.4"><h3 data-number="20.3.4" class="anchored" data-anchor-id="namespace">
<span class="header-section-number">20.3.4</span> Namespace</h3>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L4433 -->
<ul>
<li>
<strong>Checking if there is a namespace</strong>. You must have a <code>NAMESPACE</code> file. This is handled for your automatically by the devtools workflow.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L3620 --><ul>
<li>
<strong>Checking package namespace information</strong>. The <code>NAMESPACE</code> should be parseable by <code><a href="https://rdrr.io/r/base/ns-internal.html">parseNamespaceFile()</a></code> and valid. If this check fails, it’s a bug in roxygen2.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L2234 --><ul>
<li>
<strong>Checking whether the package can be loaded with stated dependencies</strong>. Runs <code><a href="https://rdrr.io/r/base/library.html">library(pkg)</a></code> with <code>R_DEFAULT_PACKAGES=NULL</code>, so the search path is empty (i.e.&nbsp;stats, graphics, grDevices, utils, datasets and methods are not attached like usual). Failure here typically indicates that you’re missing a dependency on one of those packages.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L2264 --><ul>
<li>
<strong>Checking whether the namespace can be loaded with stated dependencies</strong>. Runs <code>loadNamespace(pkg)</code> with <code>R_DEFAULT_PACKAGES=NULL</code>. Failure usually indicates a problem with the namespace.</li>
</ul></section><section id="r-code" class="level3" data-number="20.3.5"><h3 data-number="20.3.5" class="anchored" data-anchor-id="r-code">
<span class="header-section-number">20.3.5</span> R code</h3>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L1226 -->
<ul>
<li>
<strong>Checking R files for non-ASCII characters</strong>. For maximum portability (i.e.&nbsp;so people can use your package on Windows) you should avoid using non-ASCII characters in R files. It’s ok to use them in comments, but object names shouldn’t use them, and in strings you should use unicode escapes. See <a href="Code.html#sec-code-cran"><span>Section&nbsp;7.8</span></a> for more details.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L1258 --><ul>
<li>
<strong>Checking R files for syntax errors</strong>. Obviously your R code must be valid. You’re unlikely to see this error if you’ve been regularly using <code><a href="https://devtools.r-lib.org/reference/load_all.html">devtools::load_all()</a></code>.</li>
</ul>
<!--- tools:::.check_packages_used ---><ul>
<li>
<p><strong>Checking dependencies in R code</strong>. Errors here often indicate that you’ve forgotten to declare a needed package in the <code>DESCRIPTION</code>. Remember that you should never use <code><a href="https://rdrr.io/r/base/library.html">require()</a></code> or <code><a href="https://rdrr.io/r/base/library.html">library()</a></code> inside a package - see <a href="dependencies.html#sec-imports"><span>Section&nbsp;11.5.4</span></a> for more details on best practices.</p>
<p>Alternatively, you may have accidentally used <code>:::</code> to access an exported function from a package. Switch to <code>::</code> instead.</p>
</li>
</ul>
<!--- tools::checkS3methods ---><ul>
<li>
<p><strong>Checking S3 generic/method consistency</strong>. S3 methods must have a compatible function signature with their generic. This means that the method must have the same arguments as its generic, with one exception: if the generic includes <code>...</code> the method can have additional arguments.</p>
<p>A common cause of this error is defining print methods, because the <code><a href="https://rdrr.io/r/base/print.html">print()</a></code> generic contains<code>...</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># BAD</span></span>
<span><span class="va">print.my_class</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Hi"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># GOOD</span></span>
<span><span class="va">print.my_class</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Hi"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Also ok</span></span>
<span><span class="va">print.my_class</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span>, <span class="va">my_arg</span> <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Hi"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</li>
</ul>
<!-- tools::checkReplaceFuns --><ul>
<li>
<strong>Checking replacement functions</strong>. Replacement functions (e.g.&nbsp;functions that are called like <code>foo(x) &lt;- y</code>), must have <code>value</code> as the last argument.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L1373
     tools:::.check_package_code_shlib
     tools:::.check_package_code_startup_functions
     tools:::.check_package_code_unload_functions
     tools:::.check_package_code_tampers
     tools:::.check_code_usage_in_package
     tools:::.check_dotInternal
     tools:::.check_package_code_assign_to_globalenv
     tools:::.check_package_code_attach
     tools:::.check_package_code_data_into_globalenv
     tools:::.check_depdef
     --><ul>
<li>
<p><strong>Checking R code for possible problems</strong>. This is a compound check for a wide range of problems:</p>
<ul>
<li><p>Calls to <code><a href="https://rdrr.io/r/base/library.dynam.html">library.dynam()</a></code> (and <code><a href="https://rdrr.io/r/base/library.dynam.html">library.dynam.unload()</a></code>) should look like <code>library.dynam("name")</code>, not <code>library.dynam("name.dll")</code>. Remove the extension to fix this error.</p></li>
<li><p>Put <code><a href="https://rdrr.io/r/base/library.dynam.html">library.dynam()</a></code> in <code>.onLoad()</code>, not <code>.onAttach()</code>; put <code><a href="https://rdrr.io/r/base/message.html">packageStartupMessage()</a></code> in <code>.onAttach()</code>, not <code>.onLoad()</code>. Put <code><a href="https://rdrr.io/r/base/library.dynam.html">library.dynam.unload()</a></code> in <code>.onUnload()</code>. If you use any of these functions, make sure they’re in the right place.</p></li>
<li><p>Don’t use <code><a href="https://rdrr.io/r/base/bindenv.html">unlockBinding()</a></code> or <code><a href="https://rdrr.io/r/utils/getFromNamespace.html">assignInNamespace()</a></code> to modify objects that don’t belong to you.</p></li>
<li><p><code><a href="https://rdrr.io/pkg/codetools/man/checkUsage.html">codetools::checkUsagePackage()</a></code> is called to check that your functions don’t use variables that don’t exist. This sometimes raises false positives with functions that use non-standard evaluation (NSE), like <code><a href="https://rdrr.io/r/base/subset.html">subset()</a></code> or <code><a href="https://rdrr.io/r/base/with.html">with()</a></code>. Generally, I think you should avoid NSE in package functions, and hence avoid this NOTE, but if you can not, see <code><a href="https://rdrr.io/r/utils/globalVariables.html">?globalVariables</a></code> for how to suppress this NOTE.</p></li>
<li><p>You are not allowed to use <code><a href="https://rdrr.io/r/base/Internal.html">.Internal()</a></code> in a package. Either call the R wrapper function, or write your own C function. (If you copy and paste the C function from base R, make sure to maintain the copyright notice, use a GPL-2 compatible license, and list R-core in the <code>Author</code> field.)</p></li>
<li><p>Similarly you are not allowed to use <code>:::</code> to access non-exported functions from other packages. Either ask the package maintainer to export the function you need, or write your own version of it using exported functions. Alternatively, if the licenses are compatible you can copy and paste the exported function into your own package. If you do this, remember to update <code>Authors@R</code>.</p></li>
<li>
<p>Don’t use <code><a href="https://rdrr.io/r/base/assign.html">assign()</a></code> to modify objects in the global environment. If you need to maintain state across function calls, create your own environment with <code>e &lt;- new.env(parent = emptyenv())</code> and set and get values in it:</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/environment.html">new.env</a></span><span class="op">(</span>parent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/environment.html">emptyenv</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">add_up</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">e</span><span class="op">$</span><span class="va">last_x</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">old</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">old</span> <span class="op">&lt;-</span> <span class="va">e</span><span class="op">$</span><span class="va">last_x</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">new</span> <span class="op">&lt;-</span> <span class="va">old</span> <span class="op">+</span> <span class="va">x</span></span>
<span>  <span class="va">e</span><span class="op">$</span><span class="va">last_x</span> <span class="op">&lt;-</span> <span class="va">new</span></span>
<span>  <span class="va">new</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">add_up</span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 10</span></span>
<span><span class="fu">add_up</span><span class="op">(</span><span class="fl">20</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 30</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</li>
<li><p>Don’t use <code><a href="https://rdrr.io/r/base/attach.html">attach()</a></code> in your code. Instead refer to variables explicitly.</p></li>
<li><p>Don’t use <code><a href="https://rdrr.io/r/utils/data.html">data()</a></code> without specifying the <code>envir</code> argument. Otherwise the data will be loaded in the global environment.</p></li>
<li><p>Don’t use deprecated or defunct functions. Update your code to use the latest versions.</p></li>
<li><p>You must use <code>TRUE</code> and <code>FALSE</code> in your code (and examples), not <code>T</code> and <code>F</code>.</p></li>
</ul>
</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L2209 --><ul>
<li>
<strong>Checking whether the package can be loaded</strong>. R loads your package with <code><a href="https://rdrr.io/r/base/library.html">library()</a></code>. Failure here typically indicates a problem with <code>.onLoad()</code> or <code>.onAttach()</code>.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L2247 --><ul>
<li>
<strong>Checking whether the package can be unloaded cleanly</strong>. Loads with <code><a href="https://rdrr.io/r/base/library.html">library()</a></code> and then <code><a href="https://rdrr.io/r/base/detach.html">detach()</a></code>es. If this fails, check <code>.onUnload()</code> and <code>.onDetach()</code>.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L2279 --><ul>
<li>
<strong>Checking whether the namespace can be unloaded cleanly</strong>. Runs <code>loadNamespace("pkg"); unloadNamespace("pkg")</code>. Check <code>.onUnload()</code> for problems.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L2300 --><ul>
<li>
<strong>Checking loading without being on the library search path</strong>. Calls <code><a href="https://rdrr.io/r/base/library.html">library(x, lib.loc = ...)</a></code>. Failure here indicates that you are making a false assumption in <code>.onLoad()</code> or <code>.onAttach()</code>.</li>
</ul></section><section id="data" class="level3" data-number="20.3.6"><h3 data-number="20.3.6" class="anchored" data-anchor-id="data">
<span class="header-section-number">20.3.6</span> Data</h3>
<!-- 
https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L1782 
tools:::.check_package_datasets
tools:::.check_package_compact_datasets
tools:::.check_package_compact_sysdata
-->
<ul>
<li>
<p><strong>Checking contents of ‘data’ directory</strong>.</p>
<ul>
<li><p>The data directory can only contain file types described in <a href="data.html#sec-data-data"><span>Section&nbsp;8.2</span></a>.</p></li>
<li><p>Data files can contain non-ASCII characters only if the encoding is correctly set. This usually shouldn’t be a problem if you’re saving <code>.Rdata</code> files. If you do see this error, look at the <code><a href="https://rdrr.io/r/base/Encoding.html">Encoding()</a></code> of each column in the data frame, and ensure none are “unknown”. (You’ll typically need to fix this somewhere in the import process).</p></li>
<li><p>If you’ve compressed a data file with <code>bzip2</code> or <code>xz</code> you need to declare at least <code>Depends: R (&gt;= 2.10)</code> in your <code>DESCRIPTION</code>.</p></li>
<li><p>If you’ve used a sub-optimal compression algorithm for your data, re-compress with the suggested algorithm.</p></li>
</ul>
</li>
</ul></section><section id="documentation" class="level3" data-number="20.3.7"><h3 data-number="20.3.7" class="anchored" data-anchor-id="documentation">
<span class="header-section-number">20.3.7</span> Documentation</h3>
<p>You can run the most common of these outside <code><a href="https://devtools.r-lib.org/reference/check.html">devtools::check()</a></code> with <code><a href="https://devtools.r-lib.org/reference/check_man.html">devtools::check_man()</a></code> (which automatically calls <code><a href="https://devtools.r-lib.org/reference/document.html">devtools::document()</a></code> for you). If you have documentation problems, it’s best to iterate quickly with <code>check_man()</code>, rather than running the full check each time.</p>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L1527 -->
<ul>
<li>
<strong>Checking Rd files</strong>. This checks that all <code>man/*.Rd</code> files use the correct Rd syntax. If this fails, it indicates a bug in roxygen2.</li>
</ul>
<!-- tools:::.check_Rd_metadata --><ul>
<li>
<strong>Checking Rd metadata</strong>. Names and aliases must be unique across all documentation files in a package. If you encounter this problem you’ve accidentally used the same <code>@name</code> or <code>@aliases</code> in multiple places; make sure they’re unique.</li>
</ul>
<!-- tools:::.check_Rd_line_widths --><ul>
<li>
<strong>Checking Rd line widths</strong>. Lines in Rd files must be less than 90 characters wide. This is unlikely to occur if you wrap your R code, and hence roxygen comments, to 80 characters. For very long urls, use a link-shortening service like <a href="http://bit.ly">bit.ly</a>.</li>
</ul>
<!-- tools:::.check_Rd_xrefs --><ul>
<li>
<strong>Checking Rd cross-references</strong>. Errors here usually represent typos. Recall the syntax for linking to functions in other packages: <code>\link[package_name]{function_name}</code>. Sometimes I accidentally switch the order of <code>\code{}</code> and <code>\link{}</code>: <code>\link{\code{function}}</code> will not work.</li>
</ul>
<!-- tools::undoc --><ul>
<li>
<strong>Checking for missing documentation entries</strong>. All exported objects must be documented. See <code><a href="https://rdrr.io/r/tools/undoc.html">?tools::undoc</a></code> for more details.</li>
</ul>
<!-- tools::codoc, tools::codocData, tools::codocClasses --><ul>
<li>
<strong>Checking for code/documentation mismatches</strong>. This check ensures that the documentation matches the code. This should never fail because you’re using roxygen2 which automatically keeps them in sync.</li>
</ul>
<!-- tools::checkDocFiles, tools::checkDocStyle --><ul>
<li>
<p><strong>Checking Rd <code>\usage</code> sections</strong>. All arguments must be documented, and all <code>@params</code> must document an existing argument. You may have forgotten to document an argument, forgotten to remove the documentation for an argument that you’ve removed, or misspelled an argument name.</p>
<p>S3 and S4 methods need to use special <code>\S3method{}</code> and <code>\S4method{}</code> markup in the Rd file. Roxygen2 will generate this for you automatically.</p>
</li>
</ul>
<!-- tools:::.check_Rd_contents --><ul>
<li>
<strong>Checking Rd contents</strong>. This checks for autogenerated content made by <code><a href="https://rdrr.io/r/utils/package.skeleton.html">package.skeleton()</a></code>. Since you’re not using <code><a href="https://rdrr.io/r/utils/package.skeleton.html">package.skeleton()</a></code> you should never have a problem here.</li>
</ul>
<!-- tools:::.check_packages_used_in_examples --><ul>
<li>
<p><strong>Checking for unstated dependencies in examples</strong>. If you use a package only for an example, make sure it’s listed in the <code>Suggests</code> field. Before running example code that depends on it, test to see if it’s available with <code><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace("pkg", quietly = TRUE)</a></code>:</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#' @examples</span></span>
<span><span class="co">#' if (requireNamespace("dplyr", quietly = TRUE)) {</span></span>
<span><span class="co">#'   ...</span></span>
<span><span class="co">#' }</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L2317 --><ul>
<li>
<strong>Checking examples</strong>. Every documentation example must run without errors, and must not take too long. See sec-examples for details.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L2925 --><ul>
<li>
<strong>Checking PDF version of manual</strong>. Occassionally you’ll get an error when building the PDF manual. This is usually because the pdf is built by latex and you’ve forgotten to escape something. Debugging this is painful - your best bet is to look up the latex logs and combined tex file and work back from there to <code>.Rd</code> files then back to a roxygen comment. I consider any such failure to be a bug in roxygen2, so please let me know.</li>
</ul></section><section id="demos" class="level3" data-number="20.3.8"><h3 data-number="20.3.8" class="anchored" data-anchor-id="demos">
<span class="header-section-number">20.3.8</span> Demos</h3>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L877 -->
<ul>
<li>
<p><strong>Checking index information</strong>. If you’ve written demos, each demo must be listed in <code>demo/00Index</code>. The file should look like:</p>
<pre><code>demo-name-without-extension  Demo description
another-demo-name            Another description</code></pre>
</li>
</ul></section><section id="compiled-code" class="level3" data-number="20.3.9"><h3 data-number="20.3.9" class="anchored" data-anchor-id="compiled-code">
<span class="header-section-number">20.3.9</span> Compiled code</h3>
<!-- tools::checkFF -->
<ul>
<li>
<strong>Checking foreign function calls</strong>. <code><a href="https://rdrr.io/r/base/CallExternal.html">.Call()</a></code>, <code><a href="https://rdrr.io/r/base/Foreign.html">.C()</a></code>, <code><a href="https://rdrr.io/r/base/Foreign.html">.Fortran()</a></code>, <code><a href="https://rdrr.io/r/base/CallExternal.html">.External()</a></code> must always be called either with a <code>NativeSymbolInfo</code> object (as created with <code>@useDynLib</code>) or use the <code>.package</code> argument. See <code><a href="https://rdrr.io/r/tools/checkFF.html">?tools::checkFF</a></code> for more details.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L2065 --><ul>
<li>
<strong>Checking line endings in C/C++/Fortran sources/headers</strong>. Always use LF as a line ending.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L2084 --><ul>
<li>
<strong>Checking line endings in Makefiles</strong>. As above.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L2120 --><ul>
<li>
<strong>Checking for portable use of <code>$(BLAS_LIBS)</code> and <code>$(LAPACK_LIBS)</code></strong>. Errors here indicate an issue with your use of BLAS and LAPACK.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L2159 
 tools:::check_compiled_code
 --><ul>
<li>
<strong>Checking compiled code</strong>. Checks that you’re not using any C functions that you shouldn’t. ### Tests {#tests}</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L2514 --><ul>
<li>
<strong>Checking for unstated dependencies in tests</strong>. Every package used by tests must be included in the dependencies.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L2526 --><ul>
<li>
<p><strong>Checking tests</strong>. Each file in <code>tests/</code> is run. If you’ve followed the instructions in <a href="testing-basics.html"><span>Chapter&nbsp;13</span></a> you’ll have at least one file: <code>testthat.R</code>. The output from <code>R CMD check</code> is not usually that helpful, so you may need to look at the logfile <code>package.Rcheck/tests/testthat.Rout</code>. Fix any failing tests by iterating with <code><a href="https://devtools.r-lib.org/reference/test.html">devtools::test()</a></code>.</p>
<p>Occasionally you may have a problem where the tests pass when run interactively with <code><a href="https://devtools.r-lib.org/reference/test.html">devtools::test()</a></code>, but fail when in <code>R CMD check</code>. This usually indicates that you’ve made a faulty assumption about the testing environment, and it’s often hard to figure it out.</p>
</li>
</ul></section><section id="vignettes" class="level3" data-number="20.3.10"><h3 data-number="20.3.10" class="anchored" data-anchor-id="vignettes">
<span class="header-section-number">20.3.10</span> Vignettes</h3>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L718 -->
<ul>
<li>
<strong>Checking ‘build’ directory</strong>. <code>build/</code> is used to track vignette builds. I’m not sure how this check could fail unless you’ve accidentally <code>.Rbuildignore</code>d the <code>build/</code> directory.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L1846 --><ul>
<li>
<strong>Checking installed files from ‘inst/doc’</strong>. Don’t put files in <code>inst/doc</code> - vignettes now live in <code>vignettes/</code>.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L1941 --><ul>
<li>
<strong>Checking files in ‘vignettes’</strong>. Problems here are usually straightforward - you’ve included files that are already included in R (like <code>jss.cls</code>, <code>jss.bst</code>, or <code>Sweave.sty</code>), or you have leftover latex compilation files. Delete these files.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L2008 --><ul>
<li>
<strong>Checking for sizes of PDF files under ‘inst/doc’</strong>. If you’re making PDF vignettes, you can make them as small as possible by running <code><a href="https://rdrr.io/r/tools/compactPDF.html">tools::compactPDF()</a></code>.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L2619 --><ul>
<li>
<strong>Checking for unstated dependencies in vignettes</strong>. As with tests, every package that you use in a vignette must be listed in the <code>DESCRIPTION</code>. If a package is used only for a vignette, and not elsewhere, make sure it’s listed in <code>Suggests</code>.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L2629 --><ul>
<li>
<strong>Checking package vignettes in ‘inst/doc’</strong>. This checks that every source vignette (i.e.&nbsp;<code>.Rmd</code>) has a built equivalent (i.e.&nbsp;<code>.html</code>) in <code>inst/doc</code>. This shouldn’t fail if you’ve used the standard process outlined in <a href="vignettes.html"><span>Chapter&nbsp;17</span></a>. If there is a problem, start by checking your <code>.Rbuildignore</code>.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L2763 --><ul>
<li>
<strong>Checking running R code from vignettes</strong>. The R code from each vignette is run. If you want to deliberately execute errors (to show the user what failure looks like), make sure the chunk has <code>error = TRUE, purl = FALSE</code>.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L2856 --><ul>
<li>
<strong>Checking re-building of vignette outputs</strong>. Each vignette is re-knit to make sure that the output corresponds to the input. Again, this shouldn’t fail in normal circumstances.</li>
</ul>
<p>To run vignettes, the package first must be installed. That means <code>check()</code>:</p>
<ol type="1">
<li>Builds the package.</li>
<li>Installs the package without vignettes.</li>
<li>Builds all the vignettes.</li>
<li>Re-installs the package with vignettes.</li>
</ol>
<p>If you have a lot of compiled code, this can be rather slow. You may want to add <code>--no-build-vignettes</code> to the commands list in “Build Source Packages” field in the project options:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="images/project-options-build.png" class="img-fluid"></p>
</div>
</div>


</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./website.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Website</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./continuous-integration.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Continuous integration</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>